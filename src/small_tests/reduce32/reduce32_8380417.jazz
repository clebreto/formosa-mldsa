
/*
	add	r3, r0, #4194304
	asrs	r3, r3, #23
	rsb	r2, r3, r3, lsl #9
	add	r2, r3, r2, lsl #10
	rsb	r3, r3, r2, lsl #13
	add	r0, r0, r3
	bx	lr
*/

/*
int32_t reduce32(int32_t a) {
    int32_t t;

    t = (a + (1 << 22)) >> 23;
    t = a - t * Q;
    return t;
}
*/

/*************************************************
* Name:        PQCLEAN_DILITHIUM5_CLEAN_reduce32
*
* Description: For finite field element a with a <= 2^{31} - 2^{22} - 1,
*              compute r \equiv a (mod Q) such that -6283009 <= r <= 6283007.
*
* Arguments:   - int32_t: finite field element a
*
* Returns r.
**************************************************/
inline fn __reduce32_8380417(reg u32 a) -> reg u32
{
  reg u32 t t_x511 t_x523265 t_x4286586879 res;

  t = a + (1 << 22); // 1<<22 == 4194304
  t = t >>s 23; // we have that: t = (a + (1 << 22)) >> 23;

	t_x511 = #RSB(t, (t << 9)); // t * 2**9 - t
  t_x523265 = t + (t_x511 << 10);
  t_x4286586879 = #RSB(t, (t_x523265 << 13)); // ((t * 523265) * 2**13) - t
  
  // we have that: t_x4286586879 == t * -Q 

  res = a + t_x4286586879;

  res = res;
  return res;
}

export fn reduce32_8380417_jazz(reg u32 a) -> reg u32
{
  reg u32 r;

  r = __reduce32_8380417(a);

  return r;
}

